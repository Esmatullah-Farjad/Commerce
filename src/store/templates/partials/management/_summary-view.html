{% extends 'dashboard/dashboard-view.html' %}
{% load i18n %}
{% load static %}
{% load humanize %}
{% load custom_filters %}

{% block dashboard %}
<div class="space-y-4">

  <!-- Header + Filter -->
  <div class="rounded-2xl border border-slate-200 bg-white px-6 py-5 shadow-sm">
    <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
      <div class="flex items-start gap-3">
        <div class="mt-0.5 flex h-10 w-10 items-center justify-center rounded-xl bg-teal-50 ring-1 ring-inset ring-teal-600/15">
          <svg class="h-5 w-5 text-teal-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
              d="M3 3h18v6H3V3zm0 10h18v8H3v-8zm4-8v2m0 10v2m8-12v2m0 10v2" />
          </svg>
        </div>

        <div>
          <h1 class="text-xl font-semibold text-slate-900 leading-tight">{% trans "Store Dashboard" %}</h1>
          <p class="mt-1 text-sm text-slate-600 max-w-3xl">
            {% trans "Quick overview of sales, payments, and customer activity. Use the date range to filter results." %}
          </p>
        </div>
      </div>

      <form method="get" class="grid gap-3 sm:grid-cols-3 lg:w-[520px]">
        <div>
          <label class="text-xs font-semibold text-slate-700">{% trans 'From' %}</label>
          <div class="mt-2 relative">
            <span class="pointer-events-none absolute inset-y-0 left-3 flex items-center">
              <svg class="h-4 w-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 7V3m8 4V3M5 11h14M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </span>
            <input
              type="text"
              name="from_date"
              class="datepicker-jalali w-full rounded-xl border border-slate-200 bg-white pl-10 pr-3 py-2.5 text-sm text-slate-900 shadow-sm
                     focus:border-teal-600 focus:ring-2 focus:ring-teal-200"
              placeholder="{% trans 'YYYY-MM-DD' %}"
              value="{{ request.GET.from_date|default_if_none:'' }}"
            >
          </div>
        </div>

        <div>
          <label class="text-xs font-semibold text-slate-700">{% trans 'To' %}</label>
          <div class="mt-2 relative">
            <span class="pointer-events-none absolute inset-y-0 left-3 flex items-center">
              <svg class="h-4 w-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 7V3m8 4V3M5 11h14M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </span>
            <input
              type="text"
              name="to_date"
              class="datepicker-jalali w-full rounded-xl border border-slate-200 bg-white pl-10 pr-3 py-2.5 text-sm text-slate-900 shadow-sm
                     focus:border-teal-600 focus:ring-2 focus:ring-teal-200"
              placeholder="{% trans 'YYYY-MM-DD' %}"
              value="{{ request.GET.to_date|default_if_none:'' }}"
            >
          </div>
        </div>

        <div class="flex items-end">
          <button
            type="submit"
            class="w-full inline-flex items-center justify-center gap-2 rounded-xl bg-teal-700 px-4 py-2.5 text-sm font-semibold text-white
                   shadow-sm hover:bg-teal-800 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
          >
            <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 4h18l-7 8v6l-4 2v-8L3 4z" />
            </svg>
            {% trans 'Filter' %}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- KPI Cards -->
  <div class="grid gap-4 sm:grid-cols-2 xl:grid-cols-3">

    <!-- Today's Sales -->
    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
      <div class="flex items-start justify-between gap-4">
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.18em] text-slate-500">{% trans "Today's Sales Amount" %}</p>
          <p class="mt-2 text-2xl font-semibold text-slate-900 tabular-nums">
            {{ total_value|intcomma }} <span class="text-sm font-semibold text-slate-500">{% trans 'AFN' %}</span>
          </p>
        </div>
        <div class="flex h-10 w-10 items-center justify-center rounded-xl bg-slate-50 ring-1 ring-inset ring-slate-200">
          <svg class="h-5 w-5 text-slate-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
              d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
      </div>
    </div>

    <!-- Paid -->
    <div class="rounded-2xl border border-teal-200 bg-teal-50 p-5 shadow-sm">
      <div class="flex items-start justify-between gap-4">
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.18em] text-teal-700">{% trans "Total Paid Amount" %}</p>
          <p class="mt-2 text-2xl font-semibold text-slate-900 tabular-nums">
            {{ total_paid|intcomma }} <span class="text-sm font-semibold text-teal-700">{% trans 'AFN' %}</span>
          </p>
        </div>
        <div class="flex h-10 w-10 items-center justify-center rounded-xl bg-white/70 ring-1 ring-inset ring-teal-600/15">
          <svg class="h-5 w-5 text-teal-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
              d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
      </div>
    </div>

    <!-- Unpaid -->
    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
      <div class="flex items-start justify-between gap-4">
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.18em] text-slate-500">{% trans "Total Unpaid Amount" %}</p>
          <p class="mt-2 text-2xl font-semibold text-slate-900 tabular-nums">
            {{ total_unpaid|intcomma }} <span class="text-sm font-semibold text-slate-500">{% trans 'AFN' %}</span>
          </p>
        </div>
        <div class="flex h-10 w-10 items-center justify-center rounded-xl bg-amber-50 ring-1 ring-inset ring-amber-200">
          <svg class="h-5 w-5 text-amber-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
              d="M12 9v3m0 4h.01M10.29 3.86l-7.4 12.83A2 2 0 004.62 20h14.76a2 2 0 001.73-3.31l-7.4-12.83a2 2 0 00-3.46 0z" />
          </svg>
        </div>
      </div>
    </div>

    <!-- Customers Count -->
    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
      <div class="flex items-start justify-between gap-4">
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.18em] text-slate-500">{% trans "Today's Customers Count" %}</p>
          <p class="mt-2 text-2xl font-semibold text-slate-900 tabular-nums">
            {{ sales_details.total_customer|default:"0" }}
          </p>
        </div>
        <div class="flex h-10 w-10 items-center justify-center rounded-xl bg-slate-50 ring-1 ring-inset ring-slate-200">
          <svg class="h-5 w-5 text-slate-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
              d="M17 20h5v-2a4 4 0 00-4-4h-1M9 20H4v-2a4 4 0 014-4h1m8-4a4 4 0 10-8 0 4 4 0 008 0z" />
          </svg>
        </div>
      </div>
    </div>

    <!-- Income -->
    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
      <div class="flex items-start justify-between gap-4">
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.18em] text-slate-500">{% trans "Income" %}</p>
          <p class="mt-2 text-2xl font-semibold text-slate-900 tabular-nums">
            {{ sales_details.total_unpaid|default:"0" }} <span class="text-sm font-semibold text-slate-500">{% trans 'AFN' %}</span>
          </p>
        </div>
        <div class="flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-50 ring-1 ring-inset ring-emerald-200">
          <svg class="h-5 w-5 text-emerald-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
              d="M7 11l5-5 5 5M12 6v14" />
          </svg>
        </div>
      </div>
    </div>

    <!-- Expense -->
    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
      <div class="flex items-start justify-between gap-4">
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.18em] text-slate-500">{% trans "Expense" %}</p>
          <p class="mt-2 text-2xl font-semibold text-slate-900 tabular-nums">
            {{ sales_details.total_customer|default:"0" }} <span class="text-sm font-semibold text-slate-500">{% trans 'AFN' %}</span>
          </p>
        </div>
        <div class="flex h-10 w-10 items-center justify-center rounded-xl bg-rose-50 ring-1 ring-inset ring-rose-200">
          <svg class="h-5 w-5 text-rose-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
              d="M17 13l-5 5-5-5M12 6v12" />
          </svg>
        </div>
      </div>
    </div>

  </div>

</div>
{% endblock dashboard %}

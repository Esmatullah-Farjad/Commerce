{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="{% get_current_language as current_language %}" dir="{% if current_language == 'fa' %}rtl{% else %}ltr{% endif %}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        {% block title %}
        {% endblock title %}
    </title>
    <link rel="stylesheet" href="{% static 'styles/tailwind.css' %}?v={{ STATIC_ASSET_VERSION }}">
    <style>
        @font-face {
            font-family: "Vazirmatn";
            src: url("{% static 'font/Vazirmatn-Regular.woff2' %}") format("woff2");
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }
        @font-face {
            font-family: "Vazirmatn";
            src: url("{% static 'font/Vazirmatn-Bold.woff2' %}") format("woff2");
            font-weight: 700;
            font-style: normal;
            font-display: swap;
        }
        body {
            font-family: "Vazirmatn", sans-serif;
        }
        #app-sidebar {
            transform: translateX(-100%);
        }
        #app-shell.sidebar-open #app-sidebar {
            transform: translateX(0);
        }
        #app-shell.sidebar-open #sidebar-overlay {
            opacity: 1;
            pointer-events: auto;
        }
        [dir="rtl"] #app-sidebar {
            left: auto;
            right: 0;
            transform: translateX(100%);
        }
        [dir="rtl"] #app-shell.sidebar-open #app-sidebar {
            transform: translateX(0);
        }
        .sidebar-scroll {
            scrollbar-width: thin;
            scrollbar-color: #334155 transparent;
        }
        .sidebar-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .sidebar-scroll::-webkit-scrollbar-track {
            background: transparent;
        }
        .sidebar-scroll::-webkit-scrollbar-thumb {
            background-color: #334155;
            border-radius: 999px;
            border: 2px solid transparent;
            background-clip: content-box;
        }
        .sidebar-scroll:hover::-webkit-scrollbar-thumb {
            background-color: #475569;
        }
        @media (min-width: 1024px) {
            #app-shell.has-sidebar #app-sidebar {
                transform: translateX(0) !important;
            }
            #app-shell.has-sidebar #sidebar-overlay {
                display: none;
            }
            #app-shell.has-sidebar #app-main {
                padding-left: 18rem;
            }
            [dir="rtl"] #app-shell.has-sidebar #app-main {
                padding-left: 0;
                padding-right: 18rem;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-white text-slate-900 antialiased">
    <div id="app-shell" class="relative min-h-screen {% if request.user.is_authenticated %}has-sidebar{% endif %}">
        {% if request.user.is_authenticated %}
        <div id="sidebar-overlay" class="fixed inset-0 z-30 bg-slate-950/70 opacity-0 pointer-events-none transition lg:hidden"></div>
        {% include 'navbar.html' %}
        {% endif %}
        <div id="app-main" class="min-h-screen bg-white flex flex-col">
            <header class="sticky top-0 z-20 border-b border-slate-200/80 bg-white/80 backdrop-blur">
                <div class="flex items-center justify-between px-4 py-3 lg:px-8">
                    <div class="flex items-center gap-3">
                        {% if request.user.is_authenticated %}
                        <button id="sidebar-toggle" class="lg:hidden rounded-xl border border-slate-200 bg-white p-2 text-slate-600 shadow-sm transition hover:border-primary-300 hover:text-primary-700">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
                                <path fill-rule="evenodd" d="M3 5.25A.75.75 0 0 1 3.75 4.5h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 5.25Zm0 6A.75.75 0 0 1 3.75 10.5h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 11.25Zm0 6a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd" />
                            </svg>
                        </button>
                        {% endif %}
                        <div>
                            <p class="text-xs uppercase tracking-[0.3em] text-slate-400">{% trans "Inventory" %}</p>
                            <h1 class="text-lg font-semibold text-slate-900">{% trans "Store Management System" %}</h1>
                        </div>
                    </div>
                    <div class="hidden items-center gap-2 text-xs text-slate-500 sm:flex">
                        <span class="h-2 w-2 rounded-full bg-primary-500"></span>
                        <span>{% trans "Live operations" %}</span>
                    </div>
                </div>
            </header>
            <main class="flex-1 px-4 py-6 lg:px-8">
                <div class="mx-auto w-full max-w-7xl space-y-6">
                    {% if messages %}
                    <div class="space-y-3">
                        {% for message in messages %}
                        <div class="flex items-start gap-3 rounded-2xl border px-4 py-3 text-sm shadow-sm {% if message.tags == 'success' %}border-primary-200 bg-primary-50 text-primary-900{% elif message.tags == 'error' %}border-rose-200 bg-rose-50 text-rose-900{% else %}border-slate-200 bg-white text-slate-700{% endif %} message-holder">
                            <span class="mt-1 inline-flex h-6 w-6 items-center justify-center rounded-full {% if message.tags == 'success' %}bg-primary-100 text-primary-700{% elif message.tags == 'error' %}bg-rose-100 text-rose-700{% else %}bg-slate-100 text-slate-600{% endif %}">
                                {% if message.tags == "success" %}
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 w-4">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                </svg>
                                {% elif message.tags == "error" %}
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 w-4">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                </svg>
                                {% else %}
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 w-4">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 6h.008v.008H12v-.008Z" />
                                </svg>
                                {% endif %}
                            </span>
                            <div class="font-medium">{{ message }}</div>
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}
                    {% block content %}
                    {% endblock content %}
                </div>
            </main>
            {% if not request.user.is_authenticated %}
            {% include 'footer.html' %}
            {% endif %}
        </div>
    </div>
    <script src="{% static 'js/htmx.min.js' %}"></script>
    <script>
        const shell = document.getElementById("app-shell");
        const toggle = document.getElementById("sidebar-toggle");
        const overlay = document.getElementById("sidebar-overlay");
        if (toggle) {
            toggle.addEventListener("click", () => {
                shell.classList.toggle("sidebar-open");
            });
        }
        if (overlay) {
            overlay.addEventListener("click", () => {
                shell.classList.remove("sidebar-open");
            });
        }
        setTimeout(() => {
            document.querySelectorAll(".message-holder").forEach((el) => {
                el.remove();
            });
        }, 4000);
    </script>
</body>
</html>


{% comment %} Run npm install, then npm run build:css to generate tailwind.css (this is the file the template now loads). {% endcomment %}
